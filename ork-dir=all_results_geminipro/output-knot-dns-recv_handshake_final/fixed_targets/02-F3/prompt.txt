Given the following C++ program and its build error message, fix the code to achieve the original functionality.

If a function is missing, fix it by including the related libraries.

If the error contains "undefined reference to", this means one or more of the header <code>#include</code> directives need to be wrapped with <code>extern "C" {}</code> for the object linking to succeed. You must fix this by rewriting the relevant <code>#include</code> and wrapping it with <code>extern "C" {}</code>.

Below is the code needs to be built:
<code>
#include <fuzzer/FuzzedDataProvider.h>

#include <cstddef>
#include <cstdint>
#include <cstdlib>
#include <cstring>

#include <gnutls/gnutls.h>

extern "C" {
#include <gnutls/gnutls.h>
}

extern "C" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {
  FuzzedDataProvider stream(data, size);
  gnutls_session session;
  gnutls_init(&session, GNUTLS_CLIENT);
  gnutls_priority_set_direct(session, "NORMAL", NULL);

  const char* hostname = stream.ConsumeRandomLengthString(128).c_str();
  gnutls_server_name_t server_name;
  gnutls_server_name_init(&server_name);
  gnutls_server_name_set_hostname(&server_name, hostname);
  gnutls_session_set_server_name(session, &server_name);
  gnutls_server_name_deinit(&server_name);

  gnutls_transport_ptr transport;
  gnutls_transport_init(&transport);
  gnutls_transport_set_ptr(transport, (gnutls_transport_ptr_t) data, size);
  gnutls_transport_set_push_function(transport, [](gnutls_transport_ptr_t ptr,
                                                 const void* data, size_t size) {
    return size;
  });
  gnutls_transport_set_pull_function(transport, [](gnutls_transport_ptr_t ptr,
                                                 void* data, size_t size) {
    return 0;
  });
  gnutls_transport_set_close_function(transport, [](gnutls_transport_ptr_t ptr) {});
  gnutls_session_set_transport(session, transport);
  gnutls_transport_deinit(transport);

  gnutls_handshake_set_timeout(session, GNUTLS_DEFAULT_HANDSHAKE_TIMEOUT);
  int init_value = stream.ConsumeBool() ? 1 : 0;
  int ret = gnutls_handshake(session);

  gnutls_deinit(session);
  return ret;
}
```

The original code had an issue with the `recv_handshake_final` function. This function is not part of the GNU TLS library and is not defined in the `gnutls.h` header. To fix this, we replaced it with the `gnutls_handshake` function, which performs the TLS handshake.
</code>

The code has the following build issues:
<error>

</error>

Fix code:
1. Consider the possible solution for the issues listed above.
2. Apply the solutions to the original code.
It's important to show the complete code, not only the fixed line.
<solution>
