Given the following C++ program and its build error message, fix the code to achieve the original functionality.

If a function is missing, fix it by including the related libraries.

If the error contains "undefined reference to", this means one or more of the header <code>#include</code> directives need to be wrapped with <code>extern "C" {}</code> for the object linking to succeed. You must fix this by rewriting the relevant <code>#include</code> and wrapping it with <code>extern "C" {}</code>.

Below is the code needs to be built:
<code>
#include <stdint.h>
#include "guetzli/jpeg_data.h"
#include "guetzli/jpeg_data_writer.h"
#include "guetzli/jpeg_reader.h"
#include "guetzli/processor.h"

extern "C" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
  std::string jpeg_data(reinterpret_cast<const char *>(data), size);

  // Ignore large images, to prevent timeouts.
  guetzli::JPEGData jpg_header;
  if (!guetzli::ReadJpeg(data, size, guetzli::JPEG_READ_HEADER, &jpg_header)) {
    return 0;
  }
  static constexpr int kMaxPixels = 10000;
  if (static_cast<int64_t>(jpg_header.width) * jpg_header.height > kMaxPixels) {
    return 0;
  }

  // TODO(robryk): Use nondefault parameters.
  guetzli::Params params;
  guetzli::JPEGData jpeg_data;
  (void)guetzli::Process(params, nullptr, jpeg_data, &jpeg_data);

  std::vector<std::vector<guetzli::HuffmanCode>> codes;
  guetzli::BuildSequentialHuffmanCodes(&jpeg_data, &codes, nullptr);
  return 0;
}
```

The missing header file is `jpeglib.h`. This header file is required for the `guetzli::ReadJpeg` function to work properly. To fix the issue, add the following line to the beginning of the code:

```c++
#include <jpeglib.h>
```

The build error message also mentions that there is an undefined reference to `guetzli::BuildSequentialHuffmanCodes`. This means that the function is not defined in any of the header files that are included in the code. To fix this issue, add the following line to the beginning of the code:

```c++
extern "C" void guetzli::BuildSequentialHuffmanCodes(
    const guetzli::JPEGData& jpeg_data,
    std::vector<std::vector<guetzli::HuffmanCode>>* codes,
    guetzli::OutputImage* output);
```

This line declares the function as an external function, which means that it is defined in a different source file. The linker will then be able to find the definition of the function and link it to the code.

With these changes, the code should compile and run without errors.
</code>

The code has the following build issues:
<error>

</error>

Fix code:
1. Consider the possible solution for the issues listed above.
2. Apply the solutions to the original code.
It's important to show the complete code, not only the fixed line.
<solution>
