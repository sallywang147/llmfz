Given the following C++ program and its build error message, fix the code to achieve the original functionality.

If a function is missing, fix it by including the related libraries.

If the error contains "undefined reference to", this means one or more of the header <code>#include</code> directives need to be wrapped with <code>extern "C" {}</code> for the object linking to succeed. You must fix this by rewriting the relevant <code>#include</code> and wrapping it with <code>extern "C" {}</code>.

Below is the code needs to be built:
<code>
#include <cstddef>
#include <cstdint>
#include <cstdlib>
#include <cstring>
#include <string>

#include <fuzzer/FuzzedDataProvider.h>

#include <png.h>

extern "C" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {
  FuzzedDataProvider stream(data, size);
  const size_t png_size = stream.ConsumeIntegralInRange<size_t>(0, size);
  const std::string png_data =
      std::string(reinterpret_cast<const char*>(stream.ConsumeBytes<uint8_t>(png_size).data()),
                  png_size);

  png_structp png_ptr = png_create_read_struct(PNG_LIBPNG_VER_STRING, nullptr, nullptr, nullptr);
  if (png_ptr == nullptr) {
    return 0;
  }

  png_infop info_ptr = png_create_info_struct(png_ptr);
  if (info_ptr == nullptr) {
    png_destroy_read_struct(&png_ptr, nullptr, nullptr);
    return 0;
  }

  png_set_read_fn(png_ptr, &png_data, [](png_structp png_ptr, png_bytep out, png_size_t length) {
    png_voidp io_ptr = png_get_io_ptr(png_ptr);
    std::string* data = static_cast<std::string*>(io_ptr);
    if (length > data->size()) {
      png_error(png_ptr, "png_read_png: Read too many bytes");
    }
    memcpy(out, data->data(), length);
    data->erase(data->begin(), data->begin() + length);
  });

  const std::string transforms = stream.ConsumeRemainingBytesAsString();
  OSS_FUZZ_png_read_png(png_ptr, info_ptr, transforms.size() ? strtol(transforms.c_str(), nullptr, 0) : 0,
                        transforms.size() ? const_cast<char*>(transforms.c_str()) : nullptr);

  png_destroy_read_struct(&png_ptr, &info_ptr, nullptr);
  return 0;
}
</code>

The code has the following build issues:
<error>

</error>

Fix code:
1. Consider the possible solution for the issues listed above.
2. Apply the solutions to the original code.
It's important to show the complete code, not only the fixed line.
<solution>
