Given the following C++ program and its build error message, fix the code to achieve the original functionality.

If a function is missing, fix it by including the related libraries.

If the error contains "undefined reference to", this means one or more of the header <code>#include</code> directives need to be wrapped with <code>extern "C" {}</code> for the object linking to succeed. You must fix this by rewriting the relevant <code>#include</code> and wrapping it with <code>extern "C" {}</code>.

Below is the code needs to be built:
<code>
#include <brunsli/decode.h>
#include <brunsli/types.h>
#include <brunsli/brunsli_decode.h>
#include "../dec/state.h"

extern "C" {
struct brunsli::internal::dec::InternalState;
}

extern "C" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {
  brunsli::BrunsliStatus status;
  brunsli::internal::dec::State state;
  brunsli::internal::dec::InternalState internal_state;
  state.internal = &internal_state;

  size_t start = 0;
  for (size_t end = 0; end <= size; ++end) {
    state.data = data + start;
    state.pos = 0;
    state.len = end - start;
    status = brunsli::internal::dec::ProcessJpeg(&state, nullptr);
    brunsli::BrunsliStatus expected_status =
        end < size ? brunsli::BRUNSLI_NOT_ENOUGH_DATA : brunsli::BRUNSLI_OK;
    if (status != expected_status) return 0;
    start += state.pos;
  }

  state.internal->~InternalState();
  return 0;
}
</code>

The code has the following build issues:
<error>
c/tests/fuzz_decode_streaming.cc:7:8: error: forward declaration of struct cannot have a nested name specifier
struct brunsli::internal::dec::InternalState;
       ^~~~~~~~~~~~~~~~~~~~~~~~
c/tests/fuzz_decode_streaming.cc:13:41: error: variable has incomplete type 'brunsli::internal::dec::InternalState'
  brunsli::internal::dec::InternalState internal_state;
                                        ^
c/tests/../dec/state.h:63:8: note: forward declaration of 'brunsli::internal::dec::InternalState'
struct InternalState;
       ^
c/tests/fuzz_decode_streaming.cc:28:17: error: member access into incomplete type 'brunsli::internal::dec::InternalState'
  state.internal->~InternalState();
                ^
c/tests/../dec/state.h:63:8: note: forward declaration of 'brunsli::internal::dec::InternalState'
struct InternalState;
       ^
c/tests/fuzz_decode_streaming.cc:28:20: error: undeclared identifier 'InternalState' in destructor name
  state.internal->~InternalState();
                   ^
4 errors generated.
</error>

Fix code:
1. Consider the possible solution for the issues listed above.
2. Apply the solutions to the original code.
It's important to show the complete code, not only the fixed line.
<solution>
